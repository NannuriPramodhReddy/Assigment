package com.example.controller;

import com.example.model.ScanResult;
import com.example.service.ScanService;
import lombok.RequiredArgsConstructor;

import java.util.List;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/scans")
@CrossOrigin(origins = "http://localhost:3000")
@RequiredArgsConstructor
public class ScanController {
    private final ScanService scanService;

    @PostMapping("/{imageId}")
    public ResponseEntity<ScanResult> scanImage(@PathVariable String imageId) {
        return ResponseEntity.ok(scanService.scanImage(imageId));
    }

    @GetMapping("/{scanId}")
    public ResponseEntity<ScanResult> getScanResult(@PathVariable String scanId) {
        return ResponseEntity.ok(scanService.getScanResult(scanId));
    }

    // Optional: Add endpoint to get all scans for an image
    @GetMapping("/image/{imageId}")
    public ResponseEntity<List<ScanResult>> getScanResultsForImage(@PathVariable String imageId) {
        return ResponseEntity.ok(scanService.getScanResultsForImage(imageId));
    }
}